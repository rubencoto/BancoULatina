<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Soporte TÃ©cnico - Banco U Latina</title>
  <link rel="stylesheet" href="/css/estilos.css"/>
</head>
<body>
  <header class="header">
    <div class="container">
      <h1>ğŸ« Soporte TÃ©cnico</h1>
      <p>ObtÃ©n ayuda rÃ¡pida y personalizada para tus consultas</p>
    </div>
  </header>

  <nav>
    <div class="container">
      <a href="/cliente/inicio">ğŸ  Inicio</a>
      <a href="/cliente/billetera">ğŸ’³ Mi Billetera</a>
      <a href="/cliente/prestamos">ğŸ’° PrÃ©stamos</a>
      <a href="/cliente/calculadora-prestamo">ğŸ§® Calculadora</a>
      <a href="/cliente/solicitudes">ğŸ“„ Solicitudes</a>
      <a href="/cliente/tickets" class="active">ğŸ« Soporte</a>
    </div>
  </nav>

  <div class="container">
    <!-- NotificaciÃ³n de Ã©xito -->
    <div th:if="${param.creado}" class="alert alert-success">
      âœ… Ticket creado exitosamente. Te contactaremos pronto.
    </div>

    <div class="card-grid" style="grid-template-columns: 1fr 2fr; gap: 2rem;">
      <!-- Formulario de Nuevo Ticket -->
      <div class="card">
        <div class="card-header">
          <h3>ğŸ’¬ Nuevo Ticket</h3>
          <p>Describe tu consulta o problema</p>
        </div>

        <form method="post" th:action="@{/cliente/tickets}" class="form-modern" id="ticketForm">
          <div class="form-group">
            <label for="categoria">ğŸ·ï¸ CategorÃ­a</label>
            <select name="categoria" id="categoria" required>
              <option value="">Selecciona una categorÃ­a...</option>
              <option value="Consulta General">ğŸ’¬ Consulta General</option>
              <option value="Problema con PrÃ©stamo">ğŸ’° Problema con PrÃ©stamo</option>
              <option value="Problema con Cuenta">ğŸ¦ Problema con Cuenta</option>
              <option value="Problema con Tarjeta">ğŸ’³ Problema con Tarjeta</option>
              <option value="Problema TÃ©cnico">ğŸ”§ Problema TÃ©cnico</option>
              <option value="Solicitud de InformaciÃ³n">ğŸ“‹ Solicitud de InformaciÃ³n</option>
              <option value="Reclamo">âš ï¸ Reclamo</option>
              <option value="Sugerencia">ğŸ’¡ Sugerencia</option>
            </select>
          </div>

          <div class="form-group">
            <label for="descripcion">ğŸ“ DescripciÃ³n del Problema</label>
            <textarea name="descripcion"
                      id="descripcion"
                      placeholder="Describe detalladamente tu consulta o problema. Incluye toda la informaciÃ³n relevante para ayudarte mejor."
                      rows="6"
                      required></textarea>
            <small>SÃ© especÃ­fico para recibir una respuesta mÃ¡s rÃ¡pida y precisa</small>
          </div>

          <div class="form-group">
            <button type="submit" class="btn btn-primary btn-full">
              ğŸ“¤ Enviar Ticket
            </button>
          </div>
        </form>

        <!-- Consejos Ãºtiles -->
        <div class="tips-section">
          <h4>ğŸ’¡ Consejos para un mejor soporte</h4>
          <ul class="tips-list">
            <li>SÃ© especÃ­fico en tu descripciÃ³n</li>
            <li>Incluye nÃºmeros de referencia si los tienes</li>
            <li>Menciona pasos que ya intentaste</li>
            <li>Indica la urgencia de tu consulta</li>
          </ul>
        </div>
      </div>

      <!-- Lista de Tickets -->
      <div class="card">
        <div class="card-header">
          <h3>ğŸ“‹ Mis Tickets de Soporte</h3>
          <span class="badge" th:text="${#lists.size(tickets)}">0</span>
        </div>

        <div th:if="${#lists.isEmpty(tickets)}" class="empty-state">
          <div class="empty-icon">ğŸ«</div>
          <h3>No tienes tickets de soporte</h3>
          <p>Â¿Necesitas ayuda? Crea tu primer ticket usando el formulario de la izquierda</p>
        </div>

        <div th:if="${not #lists.isEmpty(tickets)}" class="tickets-list">
          <div th:each="t : ${tickets}" class="ticket-item" th:classappend="${t.estado.name().toLowerCase()}">
            <div class="ticket-header">
              <div class="ticket-id">
                <span class="ticket-number">#<span th:text="${t.id}">001</span></span>
                <span class="ticket-category" th:text="${t.categoria}">Consulta General</span>
              </div>
              <span class="status-badge" th:text="${t.estado}" th:classappend="${t.estado.name().toLowerCase()}">ABIERTO</span>
            </div>

            <div class="ticket-content">
              <p class="ticket-description" th:text="${t.descripcion}">DescripciÃ³n del ticket...</p>
            </div>

            <div class="ticket-footer">
              <div class="ticket-assigned" th:if="${t.asignadoA != null}">
                <span class="assigned-label">ğŸ‘¤ Asignado a:</span>
                <span class="assigned-name" th:text="${t.asignadoA.nombreCompleto}">Juan PÃ©rez</span>
              </div>
              <div class="ticket-assigned" th:if="${t.asignadoA == null}">
                <span class="assigned-label">â³ En espera de asignaciÃ³n</span>
              </div>

              <div class="ticket-status-message">
                <div th:switch="${t.estado.name()}">
                  <div th:case="'ABIERTO'" class="status-message open">
                    ğŸ”“ Tu ticket estÃ¡ abierto y serÃ¡ atendido pronto
                  </div>
                  <div th:case="'EN_PROCESO'" class="status-message in-progress">
                    ğŸ”„ Tu ticket estÃ¡ siendo procesado por nuestro equipo
                  </div>
                  <div th:case="'RESUELTO'" class="status-message resolved">
                    âœ… Tu ticket ha sido resuelto
                  </div>
                  <div th:case="'CERRADO'" class="status-message closed">
                    ğŸ”’ Ticket cerrado
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- InformaciÃ³n de Contacto y FAQ -->
    <div class="support-info">
      <div class="card-grid" style="grid-template-columns: 1fr 1fr; gap: 2rem;">
        <div class="card">
          <h3>ğŸ“ Contacto Directo</h3>
          <div class="contact-info">
            <div class="contact-item">
              <strong>ğŸ“ TelÃ©fono:</strong>
              <span>2200-1234</span>
            </div>
            <div class="contact-item">
              <strong>ğŸ“§ Email:</strong>
              <span>soporte@bancoulatina.cr</span>
            </div>
            <div class="contact-item">
              <strong>â° Horario:</strong>
              <span>Lunes a Viernes: 8:00 AM - 6:00 PM</span>
            </div>
          </div>
        </div>

        <div class="card">
          <h3>â“ Preguntas Frecuentes</h3>
          <div class="faq-items">
            <div class="faq-item">
              <strong>Â¿CuÃ¡nto tardan en responder?</strong>
              <p>Respondemos en un plazo mÃ¡ximo de 24 horas</p>
            </div>
            <div class="faq-item">
              <strong>Â¿Puedo adjuntar archivos?</strong>
              <p>Por seguridad, envÃ­a documentos por email</p>
            </div>
            <div class="faq-item">
              <strong>Â¿CÃ³mo sÃ© si respondieron?</strong>
              <p>Te notificaremos por email cuando actualicemos tu ticket</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Contador de caracteres para el textarea
    document.getElementById('descripcion').addEventListener('input', function() {
      const maxLength = 1000;
      const currentLength = this.value.length;

      if (!document.getElementById('charCounter')) {
        const counter = document.createElement('small');
        counter.id = 'charCounter';
        this.parentNode.appendChild(counter);
      }

      const counter = document.getElementById('charCounter');
      counter.textContent = `${currentLength}/${maxLength} caracteres`;
      counter.style.color = currentLength > maxLength * 0.9 ? '#e74c3c' : '#666';
    });

    // Animaciones para los tickets
    document.addEventListener('DOMContentLoaded', function() {
      const tickets = document.querySelectorAll('.ticket-item');
      tickets.forEach((ticket, index) => {
        ticket.style.animationDelay = (index * 0.1) + 's';
        ticket.classList.add('fade-in');
      });
    });
  </script>
</body>
</html>
